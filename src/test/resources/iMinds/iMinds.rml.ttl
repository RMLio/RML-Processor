@prefix rr:      <http://www.w3.org/ns/r2rml#>.
@prefix rml:     <http://semweb.mmlab.be/ns/rml#> .
@prefix ql:      <http://semweb.mmlab.be/ns/ql#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ex:      <http://example.com/>.
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#>.
@prefix iminds:  <http://iminds.be/> .
@prefix im:      <http://semweb.mmlab.be/ns/im#> .
@prefix cerif:   <http://spi-fm.uca.es/neologism/cerif#>.
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#>.
@prefix dcterms: <http://purl.org/dc/terms/>.
@prefix owl:      <http://www.w3.org/2002/07/owl#>.


<#ResearcherMapping>
  rml:logicalSource [
    rml:sourceName "ProjectsTimesheets.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/researcher/{Resource ID}";
    rr:class cerif:Person 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate cerif:internalidentifier;
    rr:objectMap 
    [
      rml:reference "Resource ID" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Resource Contact ID" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate cerif:name;
    rr:objectMap 
    [
      rml:reference "Resource Contact ID(T)" 
    ]
  ];
     
# rr:predicateObjectMap 
#  [
#    rr:predicate im:worksforPartner;
#    rr:objectMap [
#        rr:parentTriplesMap <#PartnerMapping> ;
#        rr:joinCondition [
#            rr:child "KPL Contact ID";
#            rr:parent "Partner CRM ID";
#        ];
#   ]
#  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:worksforResearchGroup;
    rr:objectMap [
        rr:parentTriplesMap <#ResearchGroupMapping> ;
        rr:joinCondition [
            rr:child "KPL Contact ID";
            rr:parent "CRM id";
        ];
   ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:worksAtProject;
    rr:objectMap [
        rr:parentTriplesMap <#ProjectWorkMapping> ;
   ]
  ].

<#ProjectWorkMapping>
  rml:logicalSource [
    rml:sourceName "ProjectsTimesheets.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project_work/{Project}_{Year}";
    rr:class im:ProjectWork 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:project;
    rr:objectMap [
#        rr:parentTriplesMap <#ProjectMapping> ;
#        rr:joinCondition [
#            rr:child "Project";
#            rr:parent "Project code";
#        ];
         rr:template "http://iminds.be/project/{Project}";
   ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:workYear;
    rr:objectMap 
    [
      rml:reference "Year" ;
      rr:datatype xsd:gYear
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:workHoursYear;
    rr:objectMap 
    [
      rml:reference "Hours" ;
      rr:datatype xsd:float
    ]
  ].


<#ProjectMapping>
  rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iminds.be/project/{Project code}";
    rr:class cerif:Project 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate cerif:internalidentifier;
    rr:objectMap 
    [
      rml:reference "Project code" ;
      rr:datatype xsd:positiveInteger ;
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate cerif:acronym;
    rr:objectMap 
    [
      rml:reference "Project acronym" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate cerif:isClassifiedBy;
    rr:objectMap [
        rr:parentTriplesMap <#ProjectTypeMapping> 
     ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:mastertype;
    rr:objectMap 
    [
        rr:parentTriplesMap <#MasterTypeMapping> 
    ]
  ]; 

  rr:predicateObjectMap 
  [
    rr:predicate im:segment;
    rr:objectMap 
    [
      rr:parentTriplesMap <#SegmentMapping>
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:project_status;
    rr:objectMap 
    [
      rr:parentTriplesMap <#ProjectStatusMapping>
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:project_partner;
    rr:objectMap 
    [
      rr:parentTriplesMap <#ProjectPartnerMapping>;
      rr:joinCondition [
            rr:child "Partner CRM ID";
            rr:parent "Partner CRM ID";
        ];
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate cerif:startDate;
    rr:objectMap 
    [
      rml:reference "Start date" ;
      rr:datatype xsd:date;
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate cerif:endDate;
    rr:objectMap 
    [
      rml:reference "End date" ;
      rr:datatype xsd:date;
    ]
  ].
 
<#ProjectPartnerMapping>
  rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project_partner/{Project code}/{Partner CRM ID}";
    rr:class im:ProjectPartner
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:partner;
    rr:objectMap 
    [
#      rr:parentTriplesMap <#PartnerMapping> ;
#      rr:joinCondition [
#            rr:child "Partner CRM ID";
#            rr:parent "Partner CRM ID";
#        ];
    rr:template "http://iMinds.be/partner/{Partner CRM ID}"
    ]
  ]; 

  rr:predicateObjectMap 
  [
    rr:predicate im:role;
    rr:objectMap 
    [
      rr:template "http://iminds.be/project_partner/role/{Partner role}" 
    ]
  ].

    
<#PartnerMapping>
  rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/partner/{Partner CRM ID}";
    rr:class im:Partner
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Partner CRM ID" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "Partner CRM ID(T)" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:type;
    rr:objectMap 
    [
      rr:template "http://iminds.be/partner/type/{Partner type}" 
    ]
  ];

    rr:predicateObjectMap 
  [
    rr:predicate owl:sameAs;
    rr:objectMap 
    [
      rr:parentTriplesMap <#ResearchGroupMapping> ;
      rr:joinCondition [
        rr:child "Partner CRM ID";
        rr:parent "CRM id"]
    ]
  ].

<#ResearchGroupMapping>
  rml:logicalSource [
    rml:sourceName "ResearchGroups.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/research_group/{PublicationResearchGroup_Code}";
    rr:class cerif:OrganizationalUnit 
  ];

#added it to the PartnerMapping
#  rr:predicateObjectMap 
#  [
#    rr:predicate owl:sameAs;
#    rr:objectMap 
#    [
#      rr:parentTriplesMap <#PartnerMapping> ;
#      rr:joinCondition [
#        rr:child "CRM id";
#        rr:parent "Partner CRM ID"]
#    ]
#  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:department;
    rr:objectMap 
    [
      rml:reference "PublicationResearchGroup_DepartmentName" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:publication_code;
    rr:objectMap 
    [
      rml:reference "PublicationResearchGroup_Code" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:publicationGroup_id;
    rr:objectMap 
    [
      rml:reference "PublicationResearchGroup_Id" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:publication_year;
    rr:objectMap 
    [
      rml:reference "PublicationResearchGroup_PublicationYear" ;
      rr:datatype xsd:gYear
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:evi;
    rr:objectMap 
    [
      rr:parentTriplesMap <#EVIMapping> 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "CRM id" 
    ]
  ];

  rr:predicateObjectMap 
  [
    rr:predicate im:university;
    rr:objectMap 
    [
      rml:reference "University" 
    ]
  ].


 <#ProjectTypeMapping>
    rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project_type/{Projectype}";
    rr:class cerif:Classification 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Projectype" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "Projectype(T)" 
    ]
  ].

 <#MasterTypeMapping>
    rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project/mastertype/{Mastertype}";
    rr:class cerif:Classification 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Mastertype" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "Mastertype(T)" 
    ]
  ].

  <#SegmentMapping>
    rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project/segment/{Segment}";
    rr:class cerif:Classification ;
    rr:class im:Segment ;
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Segment" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "Segment(T)" 
    ]
  ].

  <#ProjectStatusMapping>
    rml:logicalSource [
    rml:sourceName "ProjectsPartners.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/project/status/{Project Status}";
    rr:class im:Status 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "Status" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "Project Status(T)" 
    ]
  ].

  <#EVIMapping>
    rml:logicalSource [
    rml:sourceName "ResearchGroups.csv";
    rml:queryLanguage ql:CSV
  ];

  rr:subjectMap [
    rr:template "http://iMinds.be/evi/{EVI code}";
    rr:class im:Status 
  ];

  rr:predicateObjectMap 
  [
    rr:predicate dcterms:identifier;
    rr:objectMap 
    [
      rml:reference "EVI code" 
    ]
  ];
      
  rr:predicateObjectMap 
  [
    rr:predicate rdfs:label;
    rr:objectMap 
    [
      rml:reference "EVI description" 
    ]
  ].
